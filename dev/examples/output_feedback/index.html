<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Output feedback · Minimax Adaptive Control</title><meta name="title" content="Output feedback · Minimax Adaptive Control"/><meta property="og:title" content="Output feedback · Minimax Adaptive Control"/><meta property="twitter:title" content="Output feedback · Minimax Adaptive Control"/><meta name="description" content="Documentation for Minimax Adaptive Control."/><meta property="og:description" content="Documentation for Minimax Adaptive Control."/><meta property="twitter:description" content="Documentation for Minimax Adaptive Control."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Minimax Adaptive Control</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../ss_double_integrator/">State Feedback: Double Integrator</a></li><li><a class="tocitem" href="../ss_delayed_integrator/">State Feedback Delayed Integrator</a></li><li class="is-active"><a class="tocitem" href>Output feedback</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Preliminaries"><span>Preliminaries</span></a></li><li><a class="tocitem" href="#Controller-synthesis"><span>Controller synthesis</span></a></li><li><a class="tocitem" href="#Simulation"><span>Simulation</span></a></li></ul></li></ul></li><li><span class="tocitem">Functions</span><ul><li><a class="tocitem" href="../../lib/constructors/">Constructors</a></li><li><a class="tocitem" href="../../lib/reduction/">Reduction</a></li><li><a class="tocitem" href="../../lib/bellman/">Bellman Inequalities</a></li><li><a class="tocitem" href="../../lib/str/">Self-tuning Regulator</a></li><li><a class="tocitem" href="../../lib/simulation/">Simulation</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Output feedback</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Output feedback</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/kjellqvist/MinimaxAdaptiveControl.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/kjellqvist/MinimaxAdaptiveControl.jl/blob/master/docs/src/examples/output_feedback.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Output-feedback-with-approximate-pole-cancellation"><a class="docs-heading-anchor" href="#Output-feedback-with-approximate-pole-cancellation">Output feedback with approximate pole cancellation</a><a id="Output-feedback-with-approximate-pole-cancellation-1"></a><a class="docs-heading-anchor-permalink" href="#Output-feedback-with-approximate-pole-cancellation" title="Permalink"></a></h1><p>This example compares the minimax adaptive controller to the self-tuning LQG controller.</p><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>The minimum phase system, <span>$G_\text{mp}$</span>, and the nonminimum-phase system, <span>$G_\text{nmp}$</span>, have state-space realizations <span>$(A, B, C_\text{mp}, D, G)$</span> and <span>$(A, B, C_\text{nmp}, D, G)$</span> respectively, where</p><p class="math-container">\[	\begin{aligned}
		A &amp; = \begin{bmatrix}1 &amp; 1\\ 0 &amp; 1\end{bmatrix}, &amp; B &amp; = \begin{bmatrix}0 \\ 1\end{bmatrix}, \\
		C_\text{mp} &amp; = \begin{bmatrix}-1/z_0 + z_0 \\ z_0\end{bmatrix}^\top, &amp; C_\text{nmp} &amp; = \begin{bmatrix}-z_0 + 1/z_0 \\ 1/z_0\end{bmatrix}^\top.
	\end{aligned}\]</p><p>Here <span>$z_0 = 1.01$</span>, <span>$G = I / 100$</span> and <span>$D = 1/10$</span>. The goal is to synthesize a controller <span>$\mu$</span> that, for as small a <span>$\gamma &gt; 0$</span> as possible, minimizes</p><p class="math-container">\[\sup_{C, w, v, N} \sum_{t = 0}^N \left(|x_t|^2_Q + |u_t|^2_R - \gamma^2 |(w_t, v_t)|^2 \right),\]</p><p>where <span>$Q = I$</span> and <span>$R = I/100$</span>.</p><h2 id="Preliminaries"><a class="docs-heading-anchor" href="#Preliminaries">Preliminaries</a><a id="Preliminaries-1"></a><a class="docs-heading-anchor-permalink" href="#Preliminaries" title="Permalink"></a></h2><p>Load the packages</p><pre><code class="language-julia hljs">using MinimaxAdaptiveControl
using LinearAlgebra, Random
using JuMP 
using Clarabel </code></pre><p>and define the <code>optimizer_factory</code> to be used throughout</p><pre><code class="language-julia hljs">optimizer_factory = () -&gt; Clarabel.Optimizer</code></pre><h2 id="Controller-synthesis"><a class="docs-heading-anchor" href="#Controller-synthesis">Controller synthesis</a><a id="Controller-synthesis-1"></a><a class="docs-heading-anchor-permalink" href="#Controller-synthesis" title="Permalink"></a></h2><h3 id="Minimax-Adaptive-Controller"><a class="docs-heading-anchor" href="#Minimax-Adaptive-Controller">Minimax Adaptive Controller</a><a id="Minimax-Adaptive-Controller-1"></a><a class="docs-heading-anchor-permalink" href="#Minimax-Adaptive-Controller" title="Permalink"></a></h3><p>We first define the nominal models</p><pre><code class="language-julia hljs">a = 1.01
A = [1.0 1.0; 0.0 1.0]
B1 = [0.0 1.0]&#39;
B2 = [0.0 1.0]&#39;
C1 = [-a + 1/a 1/a]
C2 = [-1/a + a a]
D = fill(1.0,1,1) / 10
G = [1.0 0; 0 1.0] / 100
Q = [1.0 0; 0 1.0] / 100
R = fill(1.0,1,1) / 100
γ = 20.0
sys1 = OFLinMod(A, B1, G, C1, D, Q, R)
sys2 = OFLinMod(A, B2, G, C2, D, Q, R)
sys = [sys1, sys2]</code></pre><p>We next reduce the system to principal form using <a href="../../lib/reduction/#MinimaxAdaptiveControl.reduceSys">reduceSys</a></p><pre><code class="language-julia hljs">models = [Model(optimizer_factory()), Model(optimizer_factory())]
(A, B, G, Ks, Hs) = reduceSys(sys, γ, models)</code></pre><p>and check the termination statuses as a first test that <span>$\gamma$</span> is not too small.</p><pre><code class="nohighlight hljs">julia&gt; termination_status.(models)
2-element Vector{MathOptInterface.TerminationStatusCode}:
 OPTIMAL::TerminationStatusCode = 1
 OPTIMAL::TerminationStatusCode = 1</code></pre><p>Next, we solve the periodic bellman inequalities with a period <span>$\tau = 4$</span></p><pre><code class="language-julia hljs">model = Model(optimizer_factory())
set_silent(model)
period = 4
Ps0, Psplus= MACLMIs(A, B, G, Ks, Hs, period, model)</code></pre><p>and verify that <span>$\gamma$</span> is a valid upper bound</p><pre><code class="nohighlight hljs">julia&gt; termination_status(model)
OPTIMAL::TerminationStatusCode = 1</code></pre><p>Next we synthesize the selection rule using <a href="../../lib/bellman/#MinimaxAdaptiveControl.getPeriodicSelectionRule">getPeriodicSelectionRule</a> and the controller using <a href="../../lib/constructors/#MinimaxAdaptiveControl.MAController">MAController</a></p><pre><code class="language-julia hljs">N = length(Hs) # = 2
selectionRule = getPeriodicSelectionRule(period)
mac = MAController(zeros(4), A, B, G, Ks, Hs, zeros(N), selectionRule)</code></pre><h3 id="Self-tuning-regulator:-certainty-equivalence-LQG"><a class="docs-heading-anchor" href="#Self-tuning-regulator:-certainty-equivalence-LQG">Self-tuning regulator: certainty equivalence LQG</a><a id="Self-tuning-regulator:-certainty-equivalence-LQG-1"></a><a class="docs-heading-anchor-permalink" href="#Self-tuning-regulator:-certainty-equivalence-LQG" title="Permalink"></a></h3><p>We will construct a <a href="../../lib/constructors/#MinimaxAdaptiveControl.SelfTuningLQG">SelfTuningLQG</a> object with randomized initial estimates:</p><pre><code class="language-julia hljs">A0 = randn(2, 2)
B0 = randn(2, 1)
C0 = randn(1, 2)
K0 = randn(2, 1)
S0 = Matrix{Float64}(I(2))
L0 = zeros(1, 2)
Q0 = Matrix{Float64}(I(2))
ρ0 = 1.0
xhat0 = randn(2)
nu = 2
str = SelfTuningLQG(A0, K0, C0, B0, xhat0, 0.0, 1.0, nu)</code></pre><h2 id="Simulation"><a class="docs-heading-anchor" href="#Simulation">Simulation</a><a id="Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation" title="Permalink"></a></h2><p>We will simulate for</p><pre><code class="language-julia hljs">Tdur = 2000</code></pre><p>steps. We define two equivalent simulation models as <a href="../../lib/constructors/#MinimaxAdaptiveControl.OFPlant">OFPlant</a> objects:</p><pre><code class="language-julia hljs">Asim = [1.0 1.0; 0.0 1.0]
Bsim = [0.0 1.0]&#39;
Csim = [-a + 1/a 1/a]
Dsim = fill(1.0,1,1) / 10
Gsim = [1.0 0; 0 1.0] / 100
Qsim = [1.0 0; 0 1.0] / 100
Rsim = fill(1.0,1,1) / 100
plantMAC= OFPlant(Asim, Bsim, Gsim, Csim, Dsim, zeros(2))
plantSTR = OFPlant(Asim, Bsim, Gsim, Csim, Dsim, zeros(2))</code></pre><p>Both simulations will be affected by the same process and measurement noise</p><pre><code class="language-julia hljs">processDisturbances = randn(Tdur, 2)
measurementDisturbances = randn(Tdur, 1)</code></pre><p>Next we construct matrices to store the state, input, output and metric trajectories</p><pre><code class="language-julia hljs">statesMAC = zeros(Tdur + 1, 2)
statesSTR = zeros(Tdur + 1, 2)
outputsMAC = zeros(Tdur + 1, 1)
outputsSTR = zeros(Tdur + 1, 1)
controlsMAC = zeros(Tdur, 1)
controlsSTR = zeros(Tdur, 1)
vfunMAC = getValueFunction(mac, Ps0, N)
dcMAC = InducedlpGain(0.0, 0.0, 0.0, 2)
dcSTR = InducedlpGain(0.0, 0.0, 0.0, 2)
metricsMAC = [vfunMAC, dcMAC]
metricsSTR = [dcSTR]
metricResultsMAC = zeros(Tdur + 1, length(metricsMAC))
metricResultsSTR = zeros(Tdur + 1, length(metricsSTR))</code></pre><p>Finally we run the simulations</p><pre><code class="language-julia hljs">simulate!(statesMAC, outputsMAC, controlsMAC, processDisturbances, measurementDisturbances, metricResultsMAC, metricsMAC, plantMAC, mac, Tdur)
simulate!(statesSTR, outputsSTR, controlsSTR, processDisturbances, measurementDisturbances, metricResultsSTR, metricsSTR, plantSTR, str, Tdur)</code></pre><p>and plot the results</p><pre><code class="language-julia hljs">plt = plot(layout = (2, 3), size = (800, 600))
plot!(plt[1], statesMAC, xlabel = &quot;Timestep&quot;, label = [&quot;State 1&quot; &quot;State 2&quot;], linewidth = 2, legend = :topright)
plot!(plt[2], controlsMAC, xlabel = &quot;Timestep&quot;, ylabel = &quot;Control&quot;, label = &quot;Control&quot;, linewidth = 2)
plot!(plt[3], metricResultsMAC[1:end-1, 2], xlabel = &quot;Timestep&quot;, ylabel = &quot;Induced Lp Gain&quot;, label = &quot;Induced Lp Gain&quot;, linewidth = 2)
plot!(plt[4], statesSTR, xlabel = &quot;Timestep&quot;, label = [&quot;State 1&quot; &quot;State 2&quot;], linewidth = 2)
plot!(plt[5], controlsSTR, xlabel = &quot;Timestep&quot;, ylabel = &quot;Control&quot;, label = &quot;Control&quot;, linewidth = 2)
plot!(plt[6], metricResultsSTR[1:end-1, 1], xlabel = &quot;Timestep&quot;, ylabel = &quot;Induced Lp Gain&quot;, label = &quot;Induced Lp Gain&quot;, linewidth = 2)</code></pre><p><img src="../mac_str_simulation.png" alt="Comparison of the states, controls and metrics"/></p><p>We also plot the valubound and highlight that it&#39;s periodically nonincreasing</p><pre><code class="language-julia hljs">
plot(1:numPeriods*period, metricResultsMAC[1:numPeriods*period, 1], linestyle = :solid, linewidth = 2, color = :black, label = &quot;Vbar&quot;)
plot!(inds[1:numPeriods], metricResultsMAC[inds[1:numPeriods], 1], xlabel = &quot;Timestep&quot;, ylabel = &quot;Value Function&quot;, label = &quot;Periodic Vbar&quot;, linewidth = 2, linestyle = :dash, color = :blue, marker = :circle)</code></pre><p><img src="../mac_str_value_function.png" alt="Periodic value function"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ss_delayed_integrator/">« State Feedback Delayed Integrator</a><a class="docs-footer-nextpage" href="../../lib/constructors/">Constructors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 1 August 2024 12:50">Thursday 1 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
