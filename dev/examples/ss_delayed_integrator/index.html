<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>State Feedback Delayed Integrator · Minimax Adaptive Control</title><meta name="title" content="State Feedback Delayed Integrator · Minimax Adaptive Control"/><meta property="og:title" content="State Feedback Delayed Integrator · Minimax Adaptive Control"/><meta property="twitter:title" content="State Feedback Delayed Integrator · Minimax Adaptive Control"/><meta name="description" content="Documentation for Minimax Adaptive Control."/><meta property="og:description" content="Documentation for Minimax Adaptive Control."/><meta property="twitter:description" content="Documentation for Minimax Adaptive Control."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Minimax Adaptive Control</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../ss_double_integrator/">State Feedback: Double Integrator</a></li><li class="is-active"><a class="tocitem" href>State Feedback Delayed Integrator</a><ul class="internal"><li><a class="tocitem" href="#Prerequisites"><span>Prerequisites</span></a></li><li><a class="tocitem" href="#State-feedback-models"><span>State-feedback models</span></a></li><li><a class="tocitem" href="#Bisection"><span>Bisection</span></a></li><li><a class="tocitem" href="#Results"><span>Results</span></a></li></ul></li><li><a class="tocitem" href="../output_feedback/">Output feedback</a></li></ul></li><li><span class="tocitem">Functions</span><ul><li><a class="tocitem" href="../../lib/constructors/">Constructors</a></li><li><a class="tocitem" href="../../lib/reduction/">Reduction</a></li><li><a class="tocitem" href="../../lib/bellman/">Bellman Inequalities</a></li><li><a class="tocitem" href="../../lib/str/">Self-tuning Regulator</a></li><li><a class="tocitem" href="../../lib/simulation/">Simulation</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>State Feedback Delayed Integrator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>State Feedback Delayed Integrator</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/kjellqvist/MinimaxAdaptiveControl.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/kjellqvist/MinimaxAdaptiveControl.jl/blob/master/docs/src/examples/ss_delayed_integrator.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="State-Feedback-Delayed-Integrator-Example"><a class="docs-heading-anchor" href="#State-Feedback-Delayed-Integrator-Example">State-Feedback Delayed Integrator Example</a><a id="State-Feedback-Delayed-Integrator-Example-1"></a><a class="docs-heading-anchor-permalink" href="#State-Feedback-Delayed-Integrator-Example" title="Permalink"></a></h1><p>We will study two instances of the first-order delayed integrator where the gain has unknown sign</p><p class="math-container">\[y_t = y_{t-1} + iu_{t-2} + v_{t-1},\]</p><p>where <span>$i = \pm 1$</span>. By storing the previous input signal, we can design state-feedback controllers. Consider the two implementations</p><p class="math-container">\[\begin{aligned}
    x_{t+1} &amp; = \underbrace{\begin{bmatrix}
        1 &amp; i \\ 0 &amp; 0
    \end{bmatrix}}_{A_i} x_t + \underbrace{\begin{bmatrix} 0 \\ 1 \end{bmatrix}}_{B} \\
    x_{t+1} &amp; = \underbrace{\begin{bmatrix}
        1 &amp; 1 \\ 0 &amp; 0
    \end{bmatrix}}_{A} x_t + \underbrace{\begin{bmatrix} 0 \\ i \end{bmatrix}}_{B_i}
\end{aligned}
\]</p><p>We will refer to these models as <span>$A_i$</span> and <span>$B_i$</span> respectively. In the <span>$B_i$</span> model, the sign of  the gain is revealed immediately upon applying the control signal, while in <span>$A_i$</span> the uncertainty is revealed through the delayed effect on the first state. We will proceed to design minimax adaptive controllers with periodic switching for these two systems, and compare the gain bounds.</p><h2 id="Prerequisites"><a class="docs-heading-anchor" href="#Prerequisites">Prerequisites</a><a id="Prerequisites-1"></a><a class="docs-heading-anchor-permalink" href="#Prerequisites" title="Permalink"></a></h2><p>Load the following packages</p><pre><code class="language-julia hljs">using MinimaxAdaptiveControl
using LinearAlgebra
using JuMP
using Plots
using Clarabel # Optimization solver</code></pre><p>We are using <a href="https://github.com/oxfordcontrol/Clarabel.jl">Clarabel.jl</a>, but any SDP solver <a href="https://github.com/jump-dev/JuMP.jl">JuMP.jl</a> will do.  See the following <a href="https://jump.dev/JuMP.jl/stable/packages/solvers/">list</a>.</p><p>We define an auxillary function to pass the <code>optimizer_factory</code> to JuMP&#39;s <code>Model</code> constructor.  Just substitute this with whatever solver you want to use.</p><pre><code class="language-julia hljs">optimizer_factory=() -&gt; Hypatia.Optimizer</code></pre><h2 id="State-feedback-models"><a class="docs-heading-anchor" href="#State-feedback-models">State-feedback models</a><a id="State-feedback-models-1"></a><a class="docs-heading-anchor-permalink" href="#State-feedback-models" title="Permalink"></a></h2><p>We will define <span>$A_i$</span> and <span>$B_i$</span> as vectors, eaching containing two <a href="../../lib/constructors/#MinimaxAdaptiveControl.SSLinMod">SSLinMod</a> objects.</p><pre><code class="language-julia hljs"># Define Ai system
A1 = [1. 1; 0 0]
A2 = [1. -1; 0 0]
B0 = [0 1.]&#39;
Q = [1.0 0; 0 1.0]
R = fill(1.0,1,1)
sys1 = SSLinMod(A1, B0, Q, R)
sys2 = SSLinMod(A2, B0, Q, R)
syssAi = [sys1, sys2]

# Define Bi system
A0 = [1. 1; 0 0]
B0 = [0 1.]&#39;
sys3 = SSLinMod(A0, B0, Q, R)
sys4 = SSLinMod(A0, -B0, Q, R)
syssBi = [sys3, sys4]</code></pre><h2 id="Bisection"><a class="docs-heading-anchor" href="#Bisection">Bisection</a><a id="Bisection-1"></a><a class="docs-heading-anchor-permalink" href="#Bisection" title="Permalink"></a></h2><p>The procedure for synthesizing controllers depends on a candidate <span>$\ell_2$</span>-gain level <span>$\gamma$</span>. In order to find the smallest <span>$\gamma$</span>, we will use bisection. We construct this bisection in two parts. The function <code>attemptMACLMIs(syss, γ, T)</code> takes a vector of systems, performs the reduction with <a href="../../lib/reduction/#MinimaxAdaptiveControl.reduceSys">reduceSys</a> and attempts to solve the periodic bellman inequality LMIs with period <code>T</code> using <a href="../../lib/bellman/#MinimaxAdaptiveControl.MACLMIs">MACLMIs</a>.</p><pre><code class="language-julia hljs">function attemptMACLMIs(syss, γ, T)
    N = length(syss)
    models = [Model(optimizer_factory()) for i = 1:N]
    set_silent.(models)
    (A, B, G, Ks, Hs) = reduceSys(syss, γ, models)
    model = Model(optimizer_factory())
    set_silent(model)
    Ps0, Psplus= MACLMIs(A, B, G, Ks, Hs, T, model)
    return termination_status(model)
end</code></pre><p>Next, we implement a bisection algorithm to find the smallest <span>$\gamma$</span> for which we can solve the LMIs.</p><div class="admonition is-category-warn"><header class="admonition-header">Numerics</header><div class="admonition-body"><p>Some solvers can run into numerical issues when <span>$\gamma$</span> or the period becomes large.</p></div></div><pre><code class="language-julia hljs">function bisect(syss, fun, T; gammamin = 1.0, gammamax = 500.0, tol = 1e-3)
    γmin = gammamin
    γmax = gammamax
    if fun(syss, gammamax, T) != MOI.OPTIMAL
        error(&quot;gammamax is not feasible&quot;)
    end
    while γmax - γmin &gt; tol
        γ = (γmin + γmax) / 2
        if fun(syss, γ, T) == MOI.OPTIMAL
            γmax = γ
        else
            γmin = γ
        end
    end
    return γmax
end</code></pre><h2 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h2><p>We run the bisection algorithm for the two systems with periods from <span>$1$</span> to <span>$8$</span>, setting <span>$\gamma = -1$</span> if the optimization problem is infeasible.</p><pre><code class="language-julia hljs">Tmax = 8
gammamins = zeros(Tmax, 2)
for t = 1:Tmax
    try
        gammamins[t, 1] = bisect(syssAi, attemptMACLMIs, t)
    catch
        gammamins[t, 1] = -1
    end
    try
        gammamins[t, 2] = bisect(syssBi, attemptMACLMIs, t)
    catch
        gammamins[t, 2] = -1
    end
end</code></pre><p>The resulting gain-bounds are</p><table><tr><th style="text-align: right">Period</th><th style="text-align: right"><span>$\gamma_{A_i}$</span></th><th style="text-align: right"><span>$\gamma_{B_i}$</span></th></tr><tr><td style="text-align: right">1</td><td style="text-align: right">-1</td><td style="text-align: right">5.8</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">11.2</td><td style="text-align: right">9.2</td></tr><tr><td style="text-align: right">3</td><td style="text-align: right">13.9</td><td style="text-align: right">14.0</td></tr><tr><td style="text-align: right">4</td><td style="text-align: right">17.8</td><td style="text-align: right">21.3</td></tr><tr><td style="text-align: right">5</td><td style="text-align: right">22.7</td><td style="text-align: right">32.0</td></tr><tr><td style="text-align: right">6</td><td style="text-align: right">29.2</td><td style="text-align: right">48.1</td></tr><tr><td style="text-align: right">7</td><td style="text-align: right">37.4</td><td style="text-align: right">72.3</td></tr><tr><td style="text-align: right">8</td><td style="text-align: right">48.0</td><td style="text-align: right">108.5</td></tr></table><p>We can plot them nicely using e.g. <a href="https://github.com/JuliaPy/PyPlot.jl">PyPlot</a>.</p><pre><code class="language-julia hljs">pyplot()
plot(
     gammamins, 
     seriestype=:scatter, 
     marker=[:x :o], 
     markersize = 8,
    label = [&quot;A&quot; &quot;B&quot;],
    xlabel = &quot;Period τ&quot;,
    ylabel = &quot;Gain bound γ&quot;
   )</code></pre><p><img src="../ss_delayed_integrator.png" alt="image"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ss_double_integrator/">« State Feedback: Double Integrator</a><a class="docs-footer-nextpage" href="../output_feedback/">Output feedback »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 1 August 2024 13:23">Thursday 1 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
